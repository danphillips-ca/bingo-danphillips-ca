<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Dublin Core Metadata -->
    <meta name="DC.title" content="Bingo for All">
    <meta name="DC.creator" content="Dan Phillips">
    <meta name="DC.subject" content="Bingo, Game, Fun, Social">
    <meta name="DC.description" content="A Social Bingo game designed for classroom activities, meet-and-greets, or heck - just plain old fashion BINGO.">
    <meta name="DC.publisher" content="Dan Phillips">
    <meta name="DC.contributor" content="Dan Phillips">
    <meta name="DC.date" content="2024-06-08">
    <meta name="DC.type" content="Text">
    <meta name="DC.format" content="text/html">
    <meta name="DC.identifier" content="https://bingo.danphillips.ca/">
    <meta name="DC.language" content="en">
    <meta name="DC.coverage" content="Worldwide">
    <meta name="DC.rights" content="CC-BY 4.0">
    <meta name="DC.creator.ORCID" content="https://orcid.org/0000-0002-0386-0132">
    <meta name="DC.contributor.ai" content="AI-assisted development">
    <meta name="DC.contributor" content="Special thanks to Janine McGregor for hosting a social event in 2023 in which Bingo cards encouraged people to mix and mingle.">
    <meta name="DC.contributor" content="Special thanks to Courtney Ellsworth at the Saskatchewan Health Authority for suggesting that this project can be a great orientation and engagement tool in a variety of contexts.">
    <meta name="DC.contributor" content="Special thanks to Jess Kelly for testing.">

    <!-- Open Graph Metadata for Social Media -->
    <meta property="og:title" content="Bingo everywhere">
    <meta property="og:description" content="A Social Bingo game designed for classroom activities, meet-and-greets, or heck - just plain old fashion BINGO.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bingo.danphillips.ca/">
    <meta property="og:image" content="https://bingo.danphillips.ca/images/social.webp">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <title>Bingo For All</title>

    <!--Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <!--Bootstrap CDN - script is below-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!--Custom Styles-->
    <link rel="stylesheet" href="style.css">

    <!--Favicon-->
    <link rel="icon" type="image/x-icon" href="images/favicon.svg">
</head>

<body>
    <div class="container mt-5 position-relative">
        <!-- Bingoball image -->
        <img src="images/bingoball.webp" class="peek-image d-none d-md-block" alt="Peek Image">
    
        <!-- Alert-->
        <div class="alert custom-alert alert-dismissible col-md-6 col-12 position-relative" role="alert" aria-label="Introduction and instructions">
            <h1 class="mb-4 text-center">BINGO <br/><span style="font-size:.6em;">everywhere</span></h1>
            <p>This platform lets you populate your own Bingo cards. Great for office parties, meet-and-greets, or bonding with your cynical cousins at the family picnic. Like the old Billy Mack song goes, <span style="font-style: italic;">Bingo is all around us</span>.</p>
            <p>Content is rendered by your browser and not transferred by this platform directly. However, the generated URLs can be decoded back into your file easily - so keep that in mind.</p>
            <h2 style="font-size: 1.5rem">Ready to play?</h2>
    
            <!-- File Input -->
            <input type="file" id="txtFileInput" accept=".txt, .md" class="form-control mb-3">
            <button class="btn btn-primary m-2 w-100" onclick="handleFile()">Load Your Game <i class="bi bi-stars"></i></button>
            <div id="shareableUrlContainer" class="mt-3"></div>
            <hr/>
            <!-- Instructions -->
            <h2 style="font-size: 1.5rem">Instructions</h2>
            <p>Download this template to populate bingo cards.</p>
            <div class="d-grid gap-0">
                <a href="/The Greatest Bingo Game of All Time.txt" download class="btn btn-primary mb-2">Download Template <i class="bi bi-input-cursor-text"></i></a>
                <a href="/play.html?data=eyJ0aXRsZSI6IkEgU3VtbWVyIEluIEhhbGlmYXgiLCJGcmVlIjpbIldhbGsgVXAgYSBIaWxsIiwiRWVrISBBIFJhdCEiLCJXYXRlcmZyb250IENyb3dkcyJdLCJDdWx0dXJlIjpbIk5hdHVyYWwgSGlzdG9yeSBNdXNldW0iLCJNYXJpdGltZSBNdXNldW0iLCJBZnJpY3ZpbGxlIE11c2V1bSIsIkNlbnRyYWwgTGlicmFyeSIsIkRpc2NvdmVyeSBDZW50cmUiLCJOUyBBcnQgR2FsbGFyeSIsIlBpZXIgMjEiXSwiUGF0aW9zIjpbIlN0aWxsd2VsbCIsIkdvb2QgUm9ib3QiLCJQcm9wZWxsZXIiLCJRdWlubidzIEJyZXdlcnkiLCJTdHViYm9ybiBHb2F0IiwiTWF4d2VsbCdzIFBsdW0iLCJTYWx0IFlhcmQiLCJGYXRoZXIncyBNb3VzdGFjaGUiXSwiUGFya3MiOlsiUHVibGljIEdhcmRlbnMiLCJQb2ludCBQbGVhc2FudCIsIlRoZSBDb21tb25zIiwiQ2l0YWRlbCBIaWxsIiwiU2h1YmllIiwiRm9ydCBOZWVkaGFtIl0sIkxha2VzIjpbIkNob2NvbGF0ZSBMYWtlIiwiUGVyY2VsbHMgTGFrZSIsIkZyb2cgUG9uZCIsIldpbGxpYW1zIExha2UiLCJMb25nIExha2UiLCJMYWtlIEJhbm9vayJdLCJJY2UgQ3JlYW0iOlsiRGFpcnkgQmFyIiwiRGVlIERlZSdzIiwiRmx5bm4ncyIsIkNvd3MiLCJUcmlwbGUgQSIsIkp1YmlsZWUgSnVuY3Rpb24iXX0=" class="btn btn-secondary">Try it Now <i class="bi bi-controller"></i></a>
            </div>
            <h2 style="font-size: 1.5rem">Setup</h2>
            <ul>
                <li>Populate the title (#) and headings (##) with whatever you want.</li>
                <li>Each line below that heading will be a tile that will be shuffled to appear on users BINGO cards. The typical BINGO card has 15 options per column, but so long as you have at least five you should be okay.</li>
                <li>Load your file into this platform.</li>
                <li>Share the link you receive! Every time you reload the page, you will get a new shuffled card.</li>
            </ul>
        </div>
    </div>
    

    <!-- Toast container -->
    <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3"></div>

    <!-- JavaScript -->
    <script>
        function handleFile() {
            const input = document.getElementById('txtFileInput');
            const file = input.files[0];
            if (!file) {
                alert("Please select a file.");
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const text = event.target.result;
                const jsonObject = convertTxtToJson(text);
                const base64Data = btoa(JSON.stringify(jsonObject));
                const gameData = `${window.location.origin}/play.html?data=${base64Data}`;
                displayUrl(gameData);
            };
            reader.readAsText(file);
        }

        function convertTxtToJson(txtText) {
            const lines = txtText.split(/\r\n|\n/);
            const result = {};
            let currentKey = '';

            lines.forEach(line => {
                if (line.startsWith('# ')) {
                    result.title = line.slice(2).trim();
                } else if (line.startsWith('## ')) {
                    currentKey = line.slice(3).trim();
                    result[currentKey] = [];
                } else if (line.trim()) {
                    result[currentKey].push(line.trim());
                }
            });

            return result;
        }

        function displayUrl(url) {
            const container = document.getElementById('shareableUrlContainer');
            container.innerHTML = `
                <div class="input-group mb-3">
                    <input type="text" class="form-control" value="${url}" id="shareableUrl" readonly onclick="copyToClipboard()">
                    <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard()">
                        <i class="bi bi-share"></i>
                    </button>
                    <button class="btn btn-primary" type="button" onclick="openInNewTab()">
                        <i class="bi bi-play-fill"></i>
                    </button>
                </div>
            `;
        }

        function copyToClipboard() {
            const copyText = document.getElementById('shareableUrl');
            copyText.select();
            copyText.setSelectionRange(0, 99999); // For mobile devices

            document.execCommand("copy");

            showToast("Copied to Clipboard");
        }

        function openInNewTab() {
            const url = document.getElementById('shareableUrl').value;
            window.open(url, '_blank');
        }

        function showToast(message) {
            const toastContainer = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast align-items-center text-bg-success border-0 show';
            toast.role = 'alert';
            toast.ariaLive = 'assertive';
            toast.ariaAtomic = 'true';
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
            `;
            toastContainer.appendChild(toast);

            setTimeout(() => {
                toast.classList.remove('show');
                toastContainer.removeChild(toast);
            }, 3000);
        }
    </script>

    <!-- Bootstrap Script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!--Shared Scripts-->
    <script src="script.js"></script>
</body>
</html>
